---
typora-copy-images-to: img
---

# Git - 代码管理工具

# 学习目标

- [ ] 能够概述git基本概念
- [ ] 能够概述git工作流程
- [ ] 能够使用git基本命令[重点]
- [ ] 能够使用idea操作git[重点]

# 第一章-Git介绍

## 知识点-Git介绍

### 1.目标

- [ ] 能够概述git基本概念

### 2.路径

1. 什么是Git
2. Git历史
3. Git管理方式

### 3.讲解

#### 3.1什么是Git?

![1552653275944](img/1552653275944.png)

​	Git(读音为/gɪt/。)==是一个开源的分布式版本控制系统==，可以有效、高速地处理从很小到非常大的项目版本管理。Git 是 Linus Torvalds(**林纳斯·托瓦兹**) 为了帮助管理 Linux 内核开发而开发的一个开放源码的版本控制软件。

#### 3.2Git历史

​	同生活中的许多伟大事件一样，Git 诞生于一个极富纷争大举创新的年代。Linux 内核开源项目有着为数众广的参与者。绝大多数的 Linux 内核维护工作都花在了提交补丁和保存归档的繁琐事务上（1991－2002年间）。到 2002 年，整个项目组开始启用分布式版本控制系统 BitKeeper 来管理和维护代码。

​	到 2005 年的时候，开发 BitKeeper 的商业公司同 Linux 内核开源社区的合作关系结束，他们收回了免费使用 BitKeeper 的权力。这就迫使 Linux 开源社区（特别是 Linux的缔造者 Linus Torvalds ）不得不吸取教训，只有开发一套属于自己的版本控制系统才不至于重蹈覆辙。他们对新的系统订了若干目标：

+ 速度

+ 简单的设计

+ 对非线性开发模式的强力支持（允许上千个并行开发的分支）

+ 完全分布式

+ 有能力高效管理类似 Linux 内核一样的超大规模项目（速度和数据量）

  <img src="img/Linus_Torvalds.jpeg" alt="1552653372018" style="zoom:50%;" />

#### 3.3Git管理方式

​	Git是分布式版本控制系统，那么它就没有中央服务器的，每个人的电脑就是一个完整的版本库，这样，工作的时候就不需要联网了，因为版本都是在自己的电脑上。既然每个人的电脑都有一个完整的版本库，那多个人如何协作呢？比如说自己在电脑上改了文件A，其他人也在电脑上改了文件A，这时，你们两之间只需把各自的修改推送给对方，就可以互相看到对方的修改了。

​	下图就是分布式版本控制工具管理方式：

![1552653484367](img/1552653484367.png)

### 4.小结

1. Git: 开源分布式版本控制系统.  用来管理我们的项目, 进行协同开发
2. Git历史: Linus Torvalds(**林纳斯·托瓦兹**)  为了管理linux系统的代码而开发出来的
3. Git管理方式
   + 从远程仓库(共享版本库)clone代码
   + 编辑代码
   + commit->本地仓库
   + push->远程仓库
   + 从远程仓库pull(拉取)代码



## 知识点-Git的工作流程

### 1.目标

- [ ] 能够概述git工作流程

### 2.讲解

下图展示了 Git 的工作流程：

![1565581341543](img/1565581341543.png) 

一般工作流程如下：
1. 从远程仓库中克隆 Git 资源库作为本地仓库。
2. 从本地仓库中checkout代码到本地工作区然后进行代码修改。
3. 在提交前先将代码添加到暂存区。
4. 提交修改。提交到本地仓库。本地仓库中保存修改的各个历史版本。
5. 在修改完成后，需要和团队成员共享代码时，可以将代码push到远程仓库 

### 3.小结

1. 上班第一天 装软件(git)
2. 项目经理 组长 给git账号, 仓库的url
3. 使用git软件基于git账号, 仓库的url 把远程仓库clone一下在本地仓库(自己电脑上)
4. (checkout本地仓库 到工作区间), 编写代码, 添加到缓存区,  commit到本地仓库
5. 再push到远程仓库
6. 还可以进行pull 拉取最新代码

# 第二章-Git的安装

## 实操-Git的安装[掌握]

​	最早Git是在Linux上开发的，很长一段时间内，Git也只能在Linux和Unix系统上跑。不过，慢慢地有人把它移植到了Windows上。现在，Git可以在Linux、Unix、Mac和Windows这几大平台上正常运行了。由于开发机大多数情况都是windows，所以本教程讲解windows下的git的安装及使用。

### 1.目标

- [ ] 掌握Git的安装

### 2.路径

1. git下载
2. git安装

### 3.讲解

#### 3.1 软件下载

+ 下载地址：[https://git-scm.com/download](https://git-scm.com/download)

![1552653599557](img/1552653599557.png)

+ 今天资料已提供,，大家根据不同的操作系统选择对应的安装包

![1552653725070](img/1552653725070.png)

#### 3.2软件安装

##### 3.2.1安装git for windows

![1552653742953](img/1552653742953.png)

![1552653757130](img/1552653757130.png)

一路“下一步”使用默认选项即可。(默认安装在c盘)

判断是否安装成功，输入 `git --version`

 							![1552653839186](img/1552653839186.png)

##### 3.2.2安装TortoiseGit

![1552654019250](img/1552654019250.png)

![1552654031118](img/1552654031118.png)

一路“下一步”使用默认选项即可。默认选项下会启动配置画面：

![1552654049743](img/1552654049743.png)

由于目前只有英文语言包，默认即可继续下一步。==配置git.exe，在2,1中已经安装过git-for-windows了所以在此找到git.exe所在的目录, 在3.2.1章节安装的git的bin目录下==。

![1552654130096](img/1552654130096.png)

配置开发者姓名及邮箱，每次提交代码时都会把此信息包含到提交的信息中。

![1552654154360](img/1552654154360.png)

![1552654272561](img/1552654272561.png)



使用默认配置，点击“完成”按钮完成配置。

完整完毕后在系统右键菜单中会出现git的菜单项

![1552654292832](img/1552654292832.png)



安装完成后，查看机器的用户和email

<img src="img\image-20200218204105215.png" alt="image-20200218204105215" style="zoom:50%;" />

##### 3.2.3安装中文语言包[可选]

安装中文语言包并不是必选项。可以根据个人情况来选择安装。

![1552654321301](img/1552654321301.png)

![1552654328688](img/1552654328688.png)

直接“下一步”完整完毕。语言包安装完毕后可以在TortoiseGit的”设置”中调整语言

![1552654341739](img/1552654341739.png)



### 4.小结

1. 安装的目录禁止中文和空格
2. 安装好之后, 把电脑重新启动一下



# 第三章-git的使用

## 实操-创建版本库[掌握]

### 1.目标

- [ ]  掌握创建版本库

### 2.路径

1. 使用GitBash
2. 使用TortoiseGit

### 3.讲解

#### 3.1使用GitBash

+ 创建repo01目录

  ![image-20200218205824650](img\image-20200218205824650.png)

+ 进入repo01目录, 右键点击Git Bash Here

  

  <img src="img\image-20200218205915620.png" alt="image-20200218205915620" style="zoom:50%;" />

  

+ 输入命令  `git init`

<img src="img\image-20200218210006982.png" alt="image-20200218210006982" style="zoom:50%;" />

+ 版本库创建成功，会在此目录下创建一个.git的隐藏目录（叫做版本库），如下所示

  <img src="C:\itcast\JavaEE84\git\笔记\img\image-20200218210117605.png" alt="image-20200218210117605" style="zoom:50%;" />



#### 3.2使用TortoiseGit

+ 使用TortoiseGit时只需要在目录中点击右键菜单选择“在这里创建版本库”

<img src="img\image-20200218210653635.png" alt="image-20200218210653635" style="zoom:33%;" />



<img src="img\image-20200218210754035.png" alt="image-20200218210754035" style="zoom:33%;" />

<img src="img\image-20200218210844816.png" alt="image-20200218210844816" style="zoom:50%;" />

+ 版本库创建成功，会在此目录下创建一个.git的隐藏目录（叫做版本库），如下所示

  <img src="img\image-20200218210942592.png" alt="image-20200218210942592" style="zoom:50%;" />

  ==注:在windows中如何显示隐藏目录==

  <img src="img\image-20200218211038137.png" alt="image-20200218211038137" style="zoom:33%;" />

  

### 4.小结

+ 版本库：.git目录就是版本库，将来文件都需要保存到版本库中。
+ 工作目录（工作区）：包含“.git”文件夹的目录，也就是.git文件夹的上一级目录就是工作目录。只有工作目录中的文件才能保存到版本库中。

## 知识点-添加文件[掌握]

### 1.目标

- [ ] 掌握添加文件

### 2.路径

1. 添加文件实操
2. 工作区和暂存区

### 3.讲解

#### 3.1添加文件过程

+ 在仓库目录下创建一个read.me文件

<img src="img\image-20200218211954971.png" alt="image-20200218211954971" style="zoom:50%;" />

<img src="img\image-20200218212058992.png" alt="image-20200218212058992" style="zoom:50%;" />

<img src="img\image-20200218212157213.png" alt="image-20200218212157213" style="zoom:33%;" />





+ 提交文件：在read.me上再次点击右键选择“提交”，此时将文件保存至版本库中

<img src="img\image-20200218212516260.png" alt="image-20200218212516260" style="zoom:50%;" />

+ 填写日志

  <img src="img\image-20200218212651736.png" alt="image-20200218212651736" style="zoom:50%;" />



+ 提交成功

<img src="img\image-20200218212719663.png" alt="image-20200218212719663" style="zoom:50%;" />

#### 3.2 工作区和暂存区

Git和其他版本控制系统如SVN的一个不同之处就是有暂存区的概念。

+ 什么是工作区（Working Directory）？

  工作区就是你在电脑里能看到的目录，比如我的repo01文件夹就是一个工作区。

+ 什么是版本库？

  在这个工作区目录中的“.git”隐藏文件夹是版本库。

  Git的版本库里存了很多东西，其中最重要的就是称为stage（或者叫index）的暂存区，还有Git为我们自动创建的第一个分支master，以及指向master的一个指针叫HEAD。

  如下图所示：

  ![1552655301631](img/1552655301631.png)分支和HEAD的概念我们稍后再讲。前面讲了我们把文件往Git版本库里添加的时候，是分两步执行的：

```
第一步是用git add把文件添加进去，实际上就是把文件修改添加到暂存区；
第二步是用git commit提交更改，实际上就是把暂存区的所有内容提交到当前分支（默认是master）。
```

​	因为我们创建Git版本库时，Git自动为我们创建了唯一一个master分支，所以，现在，git commit就是往master分支上提交更改。你可以简单理解为，需要提交的文件修改通通放到暂存区，然后，一次性提交暂存区的所有修改。

查看版本库，可点击“版本库浏览器”

<img src="img\image-20200218213035816.png" alt="image-20200218213035816" style="zoom:50%;" />



<img src="img\image-20200218213108354.png" alt="image-20200218213108354" style="zoom:50%;" />

### 4.小结

1. 把文本add到暂存区
2. 把暂存区的内容commit 到本地仓库
3. 如果是相同的文件修改, 只需要再commit 

## 知识点-修改文件

### 1.目标

- [ ] 掌握修改文件

### 2.路径

1. 提交修改
2. 查看修改历史
3. 差异比较
4. 还原修改

### 3.讲解

#### 3.1提交修改

​	被版本库管理的文件不可避免的要发生修改，此时只需要直接对文件修改即可。修改完毕后需要将文件的修改提交到版本库。
​	在`read.me`文件上点击右键，然后选择`Git提交(C)->"master"`

<img src="img\image-20200218213454182.png" alt="image-20200218213454182" style="zoom:50%;" />

<img src="img\image-20200218213550807.png" alt="image-20200218213550807" style="zoom:50%;" />

#### 3.2查看修改历史

​	在开发过程中可能会经常查看代码的修改历史，或者叫做修改日志。来查看某个版本是谁修改的，什么时间修改的，修改了哪些内容。

​	可以在文件上点击右键选择“显示日志”来查看文件的修改历史。

<img src="img\image-20200218213636931.png" alt="image-20200218213636931" style="zoom:50%;" />

<img src="img\image-20200218213728130.png" alt="image-20200218213728130" style="zoom:50%;" />

可以【导出】指定版本，如果编写错误，用于还原到历史版本。

<img src="img\image-20200218213845461.png" alt="image-20200218213845461" style="zoom:50%;" />

#### 3.3差异比较

当文件内容修改后，可以通过日志进行版本的差异比较。 

<img src="img\image-20200218213939217.png" alt="image-20200218213939217" style="zoom:50%;" />

#### 3.4还原修改

##### 3.4.1版本回退 (提交之后还原)

+ 在打开的版本日志查看窗口中，选择对应的版本，右键点击，选择”重置”master“到此版本(E)... 

<img src="img\image-20200218214031086.png" alt="image-20200218214031086" style="zoom:50%;" /> 

+ 在弹出的窗口中选择”确定“按钮。 

<img src="img\image-20200218214111801.png" alt="image-20200218214111801" style="zoom:50%;" />  

+ 这时候，右键点击文件，选择”还原“。 

<img src="img\image-20200218214350827.png" alt="image-20200218214350827" style="zoom:50%;" /> 

##### 3.4.2内容回退 (未提交时候的还原)

当修改的文件内容还未提交，需要还原到修改文件之前的内容的时候，可以进行如下操作： 

+ 修改文件之后，右键点击文件，选择”还原“。 

<img src="img\image-20200218215147782.png" alt="image-20200218215147782" style="zoom:33%;" />

+ 在弹出的窗口中选择”确定“按钮，文件内容就会被回退。 

  <img src="img\image-20200218215318075.png" alt="image-20200218215318075" style="zoom:33%;" />

>  ==注意：此操作会撤销所有未提交的修改，所以当做还原操作是需要慎重慎重！！！==

### 4.小结

1. 修改文件之后, 直接提交
2. 还原
   + 版本回退(提交之后还原)
   + ==内容回退(未提交时候的还原)==

## 知识点-删除文件

### 1.目标

- [ ] 掌握删除文件

### 2.路径

1. 删除文件
2. 删除文件并保留副本

### 3.讲解

#### 3.1删除文件

需要删除无用的文件时可以使用git提供的删除功能直接将文件从版本库中删除。



<img src="img\image-20200218215446644.png" alt="image-20200218215446644" style="zoom:50%;" />

此时不是真的删除，可以通过还原功能，还原文件。

<img src="img\image-20200218220123011.png" alt="image-20200218220123011" style="zoom:33%;" />

如果真的想删除文件，可以选择【提交】(本地和版本库都删除)

<img src="img\image-20200218220255128.png" alt="image-20200218220255128" style="zoom:33%;" />

<img src="img\image-20200218220347379.png" alt="image-20200218220347379" style="zoom:33%;" />

#### 3.2 删除文件并保留副本

版本库删除,但是本地还存在

<img src="img\image-20200218220528842.png" alt="image-20200218220528842" style="zoom:33%;" />

![image-20200218220613048](img\image-20200218220613048.png)

此时文件删除，但是本地参考仍然存在，执行【提交】可以删除版本库的文件，但是read.me在本地会保留。

<img src="img\image-20200218220700794.png" alt="image-20200218220700794" style="zoom:33%;" />

【提交】后，查看仓库。

<img src="img\image-20200218220613048.png" alt="image-20200218220613048" style="zoom:33%;" />

### 4.小结

1. 删除文件:  本地仓库文件删除, 自己电脑上的文件也删除, 删除操作需要提交才生效
2. 删除文件并保留副本:   本地仓库文件删除, 自己电脑上的文件还在, 删除操作需要提交才生效

## 案例-将java工程提交到版本库

### 1.需求

- [ ] 将java工程提交到版本库

### 2.讲解

+ 第一步：将参考资料中的java工程HelloProjet复制到工作目录中

<img src="img\image-20200218220830381.png" alt="image-20200218220830381" style="zoom:50%;" />

+ 第二步：将工程添加到暂存区。

<img src="img\image-20200218220926416.png" alt="image-20200218220926416" style="zoom:33%;" />

<img src="img\image-20200218220958543.png" alt="image-20200218220958543" style="zoom:33%;" />

​	点击确定



<img src="img\image-20200218221029396.png" alt="image-20200218221029396" style="zoom:33%;" />

点击【确定】完成暂存区添加。

+ 第三步：忽略文件或文件夹

  <img src="img\image-20200218221145360.png" alt="image-20200218221145360" style="zoom:33%;" />

  ​	在此工程中，并不是所有文件都需要保存到版本库中的例如“out”目录及目录下的文件就可以忽略。好在Git考虑到了大家的感受，这个问题解决起来也很简单，在Git工作区的根目录下创建一个特殊的.gitignore文件，然后把要忽略的文件名填进去，Git就会自动忽略这些文件。

  如果使用TortoiseGit的话可以使用菜单项直接进行忽略。

  <img src="img\image-20200218221707254.png" alt="image-20200218221707254" style="zoom:33%;" />

   <img src="img\image-20200218221818218.png" alt="image-20200218221818218" style="zoom:33%;" /><img src="img\image-20200218221900682.png" alt="image-20200218221900682" style="zoom:33%;" />

  选择保留本地文件。完成后在此文件夹内会多出一个.gitignore文件，这个文件就是文件忽略文件，当然也可以手工编辑。其中的内容就是把.idea out 和 HelloProjet.iml忽略掉。

  <img src="img\image-20200218221951645.png" alt="image-20200218221951645" style="zoom:33%;" />

  打开.gitinore文件

  <img src="img\image-20200218222059711.png" alt="image-20200218222059711" style="zoom:50%;" />

+ 第四步:提交代码

  将代码添加到master分支上，其中.gitignore文件也需要添加到暂存区，然后提交到版本库。

  ![1552698822268](img/1552698822268.png)

  查看版本库浏览器，不会出现.out和.idea的文件

  <img src="img\image-20200218222440800.png" alt="image-20200218222440800" style="zoom:33%;" />

  <img src="img\image-20200218222357133.png" alt="image-20200218222357133" style="zoom:33%;" />
  
  

### 3.小结

1. java项目有一些内容不需要提交, 可以进行忽略
   + target/out 不提交(忽略)
   + *.iml 不提交(忽略)
   + .idea  不提交 (忽略)



# 第四章-远程仓库

​	远程仓库可以理解为是一个共享版本库或者网络版本库。现在我们已经在本地创建了一个Git仓库，如果单人开发，本地仓库已经够用了，但是如果又想让其他人来协作开发，此时就需要把本地仓库同步到远程仓库，同时也是对本地仓库的一个备份。
​	常用的远程仓库有GitHub(https://github.com/)、码云(https://gitee.com/)等，接下来我们将演示如何将本地代码同步到码云 

## 实操-远程仓库的创建

### 1.目标

- [ ] 掌握码云上远程仓库的创建

### 2.讲解

​	首先你得在码云上创建一个账号，这个就不演示了。然后在码云上创建一个仓库. 官网：https://gitee.com/

+ 注册账号：

<img src="img\image-20200218222943197.png" alt="image-20200218222943197" style="zoom:33%;" />

+ 登录：

  <img src="img\image-20200218223219184.png" alt="image-20200218223219184" style="zoom:33%;" />

+ 新建仓库

<img src="img\image-20200218223332492.png" alt="image-20200218223332492" style="zoom:33%;" />



<img src="img\image-20200218223449989.png" alt="image-20200218223449989" style="zoom:33%;" />

<img src="img\image-20200218223542266.png" alt="image-20200218223542266" style="zoom:33%;" />

点击“创建”按钮仓库就创建成功了。

<img src="img\image-20200218223650971.png" alt="image-20200218223650971" style="zoom:33%;" />

​	码云支持两种同步方式“https”和“ssh”。如果使用https很简单基本不需要配置就可以使用，但是每次提交代码和下载代码时都需要输入用户名和密码（码云注册的账号和密码）。如果使用ssh方式就需要客户端先生成一个密钥对，即一个公钥一个私钥。然后还需要把公钥放到githib的服务器上。这两种方式在实际开发中都有应用，所以我们都需要掌握。

### 3.小结

1. 选择`码云`作为远程仓库
   + 注册账号
   + 登录
   + 创建仓库







## 实操-本地仓库同步到远程仓库

### 1.目标

- [ ] 能够把本地仓库同步到远程仓库

### 2.路径

1. ssh协议
2. 使用ssh协议同步到远程仓库
3. 使用https协议同步到远程仓库

### 3.讲解

#### 3.1ssh协议

##### 3.1.1什么是ssh协议

​	SSH 为 Secure Shell（==安全外壳协议==）的缩写，由 IETF 的网络小组（Network Working Group）所制定。SSH 是目前较可靠，专为远程登录会话和其他网络服务提供安全性的协议。利用SSH 协议可以有效防止远程管理过程中的信息泄露问题。

##### 3.1.2 基于密匙的安全验证

​	使用ssh协议通信时，推荐使用基于密钥的验证方式。你必须为自己创建一对密匙，并把公用密匙放在需要访问的服务器上。如果你要连接到SSH服务器上，客户端软件就会向服务器发出请求，请求用你的密匙进行安全验证。服务器收到请求之后，先在该服务器上你的主目录下寻找你的公用密匙，然后把它和你发送过来的公用密匙进行比较。如果两个密匙一致，服务器就用公用密匙加密“质询”（challenge）并把它发送给客户端软件。客户端软件收到“质询”之后就可以用你的私人密匙解密再把它发送给服务器。

##### 3.1.3 ssh密钥生成

- 在windows下我们可以使用 Git Bash.exe来生成密钥，可以通过开始菜单或者右键菜单打开Git Bash

<img src="img\image-20200218224116621.png" alt="image-20200218224116621" style="zoom:33%;" />

- git bash 执行命令,生命公钥和私钥

```shell
ssh-keygen -t rsa
```

<img src="img\image-20200218224243372.png" alt="image-20200218224243372" style="zoom:33%;" />

- 执行命令完成后,在window本地用户.ssh目录C:\Users\用户名\.ssh下面生成如下名称的公钥和私钥:

<img src="img\image-20200218224407287.png" alt="image-20200218224407287" style="zoom:33%;" />

##### 3.1.4 ssh密钥配置

- 密钥生成后需要在`码云`上配置密钥(共钥)本地才可以顺利访问。

<img src="img\image-20200218224528924.png" alt="image-20200218224528924" style="zoom:33%;" />

<img src="img\image-20200218224656960.png" alt="image-20200218224656960" style="zoom:33%;" />

- 在key部分将id_rsa.pub文件内容添加进去，然后点击`确定`按钮完成配置。

  <img src="img\image-20200218224753393.png" alt="image-20200218224753393" style="zoom:33%;" />

<img src="img\image-20200218224844508.png" alt="image-20200218224844508" style="zoom:33%;" />

#### 3.2使用ssh协议同步到远程仓库

##### 3.2.1 使用git bash

+ 在仓库所在的目录（C:\itcast\JavaEE84\workspace\repo01）点击右键选择“Git Bash Here”，启动git bash程序

<img src="img\image-20200218225055458.png" alt="image-20200218225055458" style="zoom:33%;" />

+ 然后在git bash中执行如下语句

```shell
git remote add origin git@gitee.com:kiwismart/javaee84.git
git push -u origin master
```

其中:git@gitee.com:kiwismart/javaee84.git 为仓库的地址(大家需要换成自己的)

<img src="img\image-20200218225310762.png" alt="image-20200218225310762" style="zoom:50%;" />

+ 如果出现如下错误(没用的话请忽视)：

  ![1552701855665](img/1552701855665.png)


可以先执行如下命令，然后再执行上面的命令

```
$ git remote rm origin
```

![1552701879377](img/1552701879377.png)

+ 查看`码云`

<img src="img\image-20200218225426566.png" alt="image-20200218225426566" style="zoom:33%;" />

##### 3.3.2使用TortoiseGit同步

【注意】：首先保证：ssh客户端需配置成git使用的客户端

<img src="img\image-20200218230048599.png" alt="image-20200218230048599" style="zoom: 33%;" />

+ 可以重新创建一个仓库

<img src="img\image-20200218230150725.png" alt="image-20200218230150725" style="zoom:33%;" />

+ 设置远端客户端仓库url

<img src="img\image-20200218230534652.png" alt="image-20200218230534652" style="zoom:33%;" />

​	Url：远程仓库的地址

​	推送URL：也是相同的（可以不填写）

​	Putty密钥：选择刚才生成的密钥中的私钥

+ 右键，选择“git 同步”

<img src="img\image-20200218230630104.png" alt="image-20200218230630104" style="zoom:33%;" />



<img src="img\image-20200218231032946.png" alt="image-20200218231032946" style="zoom:33%;" />

<img src="img\image-20200218231101166.png" alt="image-20200218231101166" style="zoom:33%;" />

+ 查看`码云`

<img src="img\image-20200218231144860.png" alt="image-20200218231144860" style="zoom:33%;" />

#### 3.3使用http协议同步到远程仓库

+ 创建仓库`javaee84_3`

![image-20200218231236498](img\image-20200218231236498.png)

+ 设置`远端`

  <img src="img\image-20200218231556759.png" alt="image-20200218231556759" style="zoom:33%;" />

  

<img src="img\image-20200218231844575.png" alt="image-20200218231844575" style="zoom:33%;" />

+ 这时候推送需要输入“用户名”和“密码”

  

  <img src="img\image-20200218231928908.png" alt="image-20200218231928908" style="zoom:33%;" />

+ 查看`码云`

  <img src="img\image-20200218232115310.png" alt="image-20200218232115310" style="zoom:33%;" />

### 4.小结

1. ssh方式
   + 创建秘钥
   + 把公钥存到码云
   + 私钥不要放到码云
2. Https
   + 输入远程服务器的账号和密码(eg: gitee)



## 实操-从远程仓库克隆

### 1.目标

​	克隆远程仓库也就是从远程把仓库复制一份到本地，克隆后会创建一个新的本地仓库。选择一个任意部署仓库的目录，然后克隆远程仓库。创建`C:\itcast\JavaEE84\workspace\clone_repo`目录，用来存放clone下来的项目

### 2.路径

1. 使用git bash进行操作
2. 使用TortoiseGi进行操作
3. 解决版本冲突

### 3.讲解

#### 3.1使用git bash

+ 使用远程仓库的 javaee84_3为例：

<img src="img\image-20200218232350121.png" alt="image-20200218232350121" style="zoom:33%;" />

+ 在目录下点击右键：

<img src="img\image-20200218232946063.png" alt="image-20200218232946063" style="zoom:33%;" />

#### 3.2使用TortoiseGi

+ 使用远程仓库的 javaee84_2为例：

<img src="img\image-20200218233211573.png" alt="image-20200218233211573" style="zoom:33%;" />

+ 在目录下点击右键：

  <img src="img\image-20200218233426190.png" alt="image-20200218233426190" style="zoom:33%;" />

  <img src="img\image-20200218233449232.png" alt="image-20200218233449232" style="zoom:33%;" />

#### 3.3解决版本冲突[重点]

##### 3.3.1制造冲突

+ 第一步：将aaa.txt文件，并推送（push）到远程仓库javaee84中。

<img src="img\image-20200218233720750.png" alt="image-20200218233720750" style="zoom:33%;" />

<img src="img\image-20200218233817835.png" alt="image-20200218233817835" style="zoom:33%;" />

+ 第二步：从远程仓库javaee84中获取代码

  

  <img src="img\image-20200218234603147.png" alt="image-20200218234603147" style="zoom:33%;" />

我们试想一下两边同时修改了aaa.txt，会出现什么结果。

先提交，不会有问题；

后提交，会怎么样？

<img src="img\image-20200218234752331.png" alt="image-20200218234752331" style="zoom:33%;" />

##### 3.3.2 解决冲突

其中，C:\itcast\JavaEE84\workspace\repo01中的aaa.txt先提交到本地仓库，再推送到远程仓库没有问题

而C:\itcast\JavaEE84\workspace\clone_repo\javaee84中的aaa.txt先提交到本地仓库，再推送到远程仓库的时候出现问题。如图：

<img src="img\image-20200218235128284.png" alt="image-20200218235128284" style="zoom:33%;" />

这个时候，先拉取远程仓库的代码到本地。

<img src="img\image-20200218235252170.png" alt="image-20200218235252170" style="zoom:33%;" />

编辑冲突：

<img src="img\image-20200218235425874.png" alt="image-20200218235425874" style="zoom:33%;" />

![1552704434198](img/1552704434198.png)

合并成一个新的文件

![1552704445746](img/1552704445746.png)

再次推送，没有问题

<img src="img\image-20200219000311786.png" alt="image-20200219000311786" style="zoom:33%;" />

### 4.小结

1. 远程仓库clone,  编写了, commit到本地, push(推送)到远程
2. ==协同开发 可能会遇到冲突==
   + 先push的没有冲突的
   + 有些公司 push之前先pull





## 实操-搭建私有Git服务器[了解] 运维

### 1.目标

​	远程仓库实际上和本地仓库没啥不同，纯粹为了7x24小时开机并交换大家的修改代码。GitHub或者码云就是一个免费托管开源代码的远程仓库。但是对于某些源代码如生命的商业公司来说，既不想公开源代码，又舍不得给GitHub或者码云交保护费，那就只能自己搭建一台Git服务器作为私有仓库使用。

### 2.路径

1. 服务器搭建
2. 上传代码到私有仓库
3. 克隆私有仓库到本地

### 3.讲解

#### 3.1 服务器搭建

​	搭建Git服务器需要准备一台运行Linux的机器，在此我们使用CentOS7.x。以下为安装步骤：

​	用户名:root 密码:12345678

​	关闭防火墙: chkconfig iptables off

##### 3.1.1安装

+ 安装git服务环境准备，联网（3-5分钟）

```shell
yum -y install curl curl-devel zlib-devel openssl-devel perl cpio expat-devel gettext-devel gcc cc
```

+ 上传git-2.5.0.tar.gz

![1552704737519](img/1552704737519.png)

+ 解压

```shell
tar -zxvf git-2.5.0.tar.gz
```

+ 进入到git目录

```shell
cd git-2.5.0
```

+ 编译，过程较慢，耐心等候

```shell
make
```

+ 安装

```shell
make install
```

+ 查看版本

```shell
git --version
```

##### 3.1.2 创建用户

+ 添加用户(此命令执行后会创建/home/git目录作为git用户的主目录)

```shell
adduser -r -c 'git version control' -d /home/git -m git
```

​	参数说明: -r 建立系统帐号;    -c<备注> 加上备注文字; 

​                   -d 指定用户登入时的启始目录;  -m 自动建立用户的登入目录

+ 设置密码

```shell
passwd git
```

​	输入两次密码

​	密码 git

+ 进入/home, 切换到git用户

```
cd /home
su git
```

![1552704973061](img/1552704973061.png)

##### 3.1.3创建git仓库

+ 创建目录

```
mkdir -p /home/git/repo01
```

+ 执行命令创建仓库

```
cd /home/git/repo01
git --bare init 
```

注意:注意：如果不使用“--bare”参数，初始化仓库后，提交master分支时报错。这是由于git默认拒绝了push操作，需要.git/config添加如下代码：

```
[receive]

      denyCurrentBranch = ignore
```

git  init 操作等同于：TortoiseGit中的

![1552705087046](img/1552705087046.png)

<img src="img\image-20200219002924806.png" alt="image-20200219002924806" style="zoom:33%;" />

#### 3.2上传代码到私有仓库

+ 选择git同步

![1552713020188](img/1552713020188.png)



+ 填写设置 Url：ssh://git@192.168.25.128/home/git/repo01  [ip换成自己虚拟机的IP]

<img src="img\image-20200219003158192.png" alt="image-20200219003158192" style="zoom:33%;" />

+ 点击推送

  <img src="img\image-20200219003252650.png" alt="image-20200219003252650" style="zoom:33%;" />

<img src="img\image-20200219003317945.png" alt="image-20200219003317945" style="zoom:33%;" />

#### 3.3 克隆私有仓库到本地

<img src="img\image-20200219003434039.png" alt="image-20200219003434039" style="zoom:33%;" />

Url：ssh://git@192.168.25.128/home/git/repo01

# 第五章-分支管理[重点]

## 实操-分支管理

### 1.目标

- [ ] 掌握分支的管理

### 2.路径

1. 分支介绍

2. 合并分支
3. 删除分支

### 3.讲解

#### 3.1分支介绍

​	在我们每次的提交，Git都把它们串成一条时间线，这条时间线就是一个分支。截止到目前，只有一条时间线，在Git里，这个分支叫主分支，即master分支。HEAD指针严格来说不是指向提交，而是指向master，master才是指向提交的，所以，HEAD指向的就是当前分支。

​	如图：只要有本地仓库就有master分支。

![1552713293315](img/1552713293315.png)

​	一开始的时候，master分支是一条线，Git用master指向最新的提交，再用HEAD指向master，就能确定当前分支，以及当前分支的提交点：

![1552713323782](img/1552713323782.png)

每次提交，master分支都会向前移动一步，这样，随着你不断提交，master分支的线也越来越长。

当我们创建新的分支，例如dev时，Git新建了一个指针叫dev，指向master相同的提交，再把HEAD指向dev，就表示当前分支在dev上：

![1552713348989](img/1552713348989.png)

你看，Git创建一个分支很快，因为除了增加一个dev指针，改改HEAD的指向，工作区的文件都没有任何变化！ 

不过，从现在开始，对工作区的修改和提交就是针对dev分支了，比如新提交一次后，dev指针往前移动一步，而master指针不变：

![1552713395183](img/1552713395183.png)

​	假如我们在dev上的工作完成了，就可以把dev合并到master上。Git怎么合并呢？最简单的方法，就是直接把master指向dev的当前提交，就完成了合并：

![1552713409730](img/1552713409730.png)



所以Git合并分支也很快！就改改指针，工作区内容也不变！

合并完分支后，甚至可以删除dev分支。删除dev分支就是把dev指针给删掉，删掉后，我们就剩下了一条master分支：

如图：查看分支、合并

![1552713431993](img/1552713431993.png)

#### 3.2使用TortoiseGit实现分支管理

![1552714425419](img/1552714425419.png)

##### 3.2.1分支管理

+ 在本地仓库文件夹中点击右键，然后从菜单中选择“创建分支”

 ![1552713485219](img/1552713485219.png)



<img src="img\image-20200219003642182.png" alt="image-20200219003642182" style="zoom:33%;" />

如果想创建完毕后直接切换到新分支可以勾选“切换到新分支”选项或者从菜单中选择“切换/检出”来切换分支：

<img src="img\image-20200219003725165.png" alt="image-20200219003725165" style="zoom:33%;" />

右键查看，再提交，指向新的分支。

<img src="img\image-20200219003805492.png" alt="image-20200219003805492" style="zoom:33%;" />

##### 3.2.2合并分支

+ 如果A分支需要合并B分支, 先切换到A分支;   如果B分支需要合并A分支,先切换到B分支

<img src="img\image-20200219003843992.png" alt="image-20200219003843992" style="zoom:33%;" />



<img src="img\image-20200219004034126.png" alt="image-20200219004034126" style="zoom:33%;" />

解决冲突后提交即可,此时可以提交到主线上。

##### 3.2.3 删除分支

+ 右键选择“切换/检出”,选择分支。

<img src="img\image-20200219004215024.png" alt="image-20200219004215024" style="zoom:33%;" />



<img src="img\image-20200219004415303.png" alt="image-20200219004415303" style="zoom:33%;" />

> 要删除这个分支, 当前不能在此分支上.

### 4.小结

1. 基于一个分支 创建一个新的分支(分支是独立的)
2. 合并分支, A合并B, 要切换到A
3. 删除分支, 删除A分支, 前提当前的分支不是A分支



# 第六章-在IntelliJ IDEA中使用git[重点]

创建一个工程

<img src="img\image-20200219004634335.png" alt="image-20200219004634335" style="zoom:33%;" />



## 实操-配置Git

### 1.目标

- [ ] 掌握在IDEA中配置Git

### 2.路径

1. 在Idea中配置git
2. 将工程添加至git

### 3.讲解

#### 3.1在Idea中配置git

​	安装好IntelliJ IDEA后，如果Git安装在默认路径下，那么idea会自动找到git的位置，如果更改了Git的安装位置则需要手动配置下Git的路径。

+ 选择File→Settings打开设置窗口，找到Version Control下的git选项：

<img src="img\image-20200219004722978.png" alt="image-20200219004722978" style="zoom:33%;" /> 

+ 选择git的安装目录后可以点击“Test”按钮测试是否正确配置。

  <img src="img\image-20200219004740277.png" alt="image-20200219004740277" style="zoom:33%;" />

#### 3.2将工程添加至git

+ 创建一个User类
+ 创建本地仓库. 在菜单中选择“vcs”→Import into Version Control→Create Git Repository...

<img src="img\image-20200219005154577.png" alt="image-20200219005154577" style="zoom:33%;" />

+ 选择工程所在的上级目录。本例中应该选择ideaProjects目录中的git目录，然后点击“OK”按钮，在工程的上级目录创建本地仓库，那么`git01-demo01` 目录就是本地仓库的工作目录，此目录中的工程就可以添加到本地仓库中。也就是可以把`git01-demo01` 工程添加到本地仓库中。

<img src="img\image-20200219005320937.png" alt="image-20200219005320937" style="zoom:33%;" />



+ 选择之后在工具栏上就多出了git相关工具按钮：

  <img src="img\image-20200219005356973.png" alt="image-20200219005356973" style="zoom:33%;" />



+ 将工程添加至本地仓库直接点击   

  

   ![1552715341689](img/1552715341689.png)

  <img src="img\image-20200219005609773.png" alt="image-20200219005609773" style="zoom:33%;" />

### 4.小结

1. 在IDEA配置Git
2. 基于项目创建Git版本库

## 实操-在IDEA中操作Git

### 1.目标

- [ ] 掌握在IDEA中操作Git

### 2.路径

1. 推送(同步)到远程仓库
2. 从远程仓库克隆
3. push到远程仓库
4. 从远程仓库pull
5. 在Idea中使用分支

### 3.讲解

#### 3.1推送到远程仓库

+ 在`码云`上创建一个仓库然后将本地仓库推送到远程。创建远程仓库itcast_git

<img src="img\image-20200219005808337.png" alt="image-20200219005808337" style="zoom:33%;" />

<img src="img\image-20200219005840863.png" alt="image-20200219005840863" style="zoom:50%;" />

​	这里注意：我们使用https的协议，因为ssh的协议无法使用idea链接。

+ 在工程上点击右键，选择git→Repository→Remotes，

  <img src="img\image-20200219010101991.png" alt="image-20200219010101991" style="zoom:33%;" />

  <img src="img\image-20200219010205507.png" alt="image-20200219010205507" style="zoom:33%;" />



+ 在工程上点击右键，选择git→Repository→Push，

<img src="img\image-20200219010328944.png" alt="image-20200219010328944" style="zoom:33%;" />

<img src="img\image-20200219010404286.png" alt="image-20200219010404286" style="zoom:33%;" />



<img src="img\image-20200219010428811.png" alt="image-20200219010428811" style="zoom:33%;" />



#### 3.2从远程仓库克隆【工作不建议】

> 建议使用小乌龟clone 再导入到IDEA里面

方式一：选择VCS--->Get from Version Control--->Repository URL

<img src="img\image-20200219010851539.png" alt="image-20200219010851539" style="zoom:33%;" />![image-20200219010952380](C:\itcast\JavaEE84\git\笔记\img\image-20200219010952380.png)

<img src="img\image-20200219010851539.png" alt="image-20200219010851539" style="zoom:33%;" />![image-20200219010952380](img\image-20200219010952380.png)

方式二：或者：关闭工程后，在idea的欢迎页上有“Checkout from version control”下拉框，选择git

![1552716159713](img/1552716159713.png)

![1552716298424](img/1552716298424.png)

+ 此处仍然推荐使用https形式的url，

![1552716348661](img/1552716348661.png)

![1552716473528](img/1552716473528.png)

+ 拉取成功

<img src="img\image-20200219011200631.png" alt="image-20200219011200631" style="zoom:33%;" />

#### 3.3push到远程仓库

+ 修改User
+ 先commit到本地

<img src="img\image-20200219011906889.png" alt="image-20200219011906889" style="zoom:33%;" />

<img src="img\image-20200219012006804.png" alt="image-20200219012006804" style="zoom:33%;" />

+ 再push到远程

  <img src="img\image-20200219012047887.png" alt="image-20200219012047887" style="zoom:33%;" />



#### 3.4从远程仓库pull

<img src="img\image-20200219012145104.png" alt="image-20200219012145104" style="zoom:33%;" />



#### 3.5在Idea中使用分支

+ 我们选择VCS--->Git--->Branches，

<img src="img\image-20200219012255796.png" alt="image-20200219012255796" style="zoom:33%;" />

<img src="img\image-20200219012426779.png" alt="image-20200219012426779" style="zoom:33%;" />

+ 我们点击“New Branch”，新建一个分支

<img src="img\image-20200219012528998.png" alt="image-20200219012528998" style="zoom:33%;" />

<img src="img\image-20200219012601326.png" alt="image-20200219012601326" style="zoom:33%;" />

<img src="img\image-20200219012622177.png" alt="image-20200219012622177" style="zoom:33%;" />



+ 分支操作

<img src="img\image-20200219012914221.png" alt="image-20200219012914221" style="zoom:33%;" />

### 4.小结

1. 提交, 推送

![1566966392478](img/1566966392478.png) 

2. 设置远程管理

![1566966420359](img/1566966420359.png) 

## 附录-忽略文件.gitignore语法规范

空行或是以# 开头的行即注释行将被忽略。

可以在前面添加正斜杠 / 来避免递归,下面的例子中可以很明白的看出来与下一条的区别。

可以在后面添加正斜杠 / 来忽略文件夹，例如build/ 即忽略build文件夹。

可以使用! 来否定忽略，即比如在前面用了*.apk ，然后使用 !a.apk ，则这个a.apk不会被忽略。

\* 用来匹配零个或多个字符，如 *.[oa] 忽略所有以".o"或".a"结尾， *~ 忽略所有以 ~ 结尾的文件（这种文件通常被许多编辑器标记为临时文件）； [] 用来匹配括号内的任一字符，如 [abc] ，也可以在括号内加连接符，如 [0-9] 匹配0至9的数； ? 用来匹配单个字符。 

看了这么多，还是应该来个例子：

```
# 忽略 .a 文件
*.a
# 不忽略 lib.a, 尽管已经在前面忽略了 .a 文件
!lib.a
# 仅在当前目录下忽略 TODO 文件， 但不包括子目录下的 subdir/TODO
/TODO
# 忽略 build/ 文件夹下的所有文件
build/
# 忽略 doc/notes.txt, 不包括 doc/server/arch.txt
doc/*.txt
# 忽略所有的 .pdf 文件 在 doc/ directory 下的
doc/**/*.pdf
```

